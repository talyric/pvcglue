#!/usr/bin/env ruby
require 'pvcglue/cli'
require 'benchmark'

# Allow use of Capistrano style environment syntax and convert to 'standard' syntax
# Example:  `pvc production bootstrap` ==> `pvc bootstrap --stage=production`
# TODO: refactor to use a list of user specified environments
if ARGV.count >= 2 && %w[local vmtest test alpha beta gamma delta preview production staging all].include?(ARGV[0])
  ARGV[0], ARGV[1] = ARGV[1], "--stage=#{ARGV[0]}"
end

Pvcglue.logger.info('Starting up...')
Pvcglue.logger.debug { ARGV.inspect }
# puts Benchmark.measure { Pvcglue::CLI.start }
# pvc_puts.warn("----- Done #{Benchmark.measure { Pvcglue::CLI.start }}")
Pvcglue.logger.info("----- Done #{Benchmark.measure { Pvcglue::CLI.start }}")